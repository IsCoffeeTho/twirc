function parseIRC(msg) { const parseMessage=e=>{let l={tags:null,source:null,command:null,parameters:null},s=0,a=null,t=null,n=null,r=null;if("@"===e[s]){let l=e.indexOf(" ");a=e.slice(1,l),s=l+1}if(":"===e[s]){s+=1;let l=e.indexOf(" ",s);t=e.slice(s,l),s=l+1}let c=e.indexOf(":",s);return-1==c&&(c=e.length),n=e.slice(s,c).trim(),c!=e.length&&(s=c+1,r=e.slice(s)),l.command=parseCommand(n),null==l.command?null:(null!=a&&(l.tags=parseTags(a)),l.source=parseSource(t),l.parameters=r,r&&"!"===r[0]&&(l.command=parseParameters(r,l.command)),l)},parseTags=e=>{const l={"client-nonce":null,flags:null};let s={};return e.split(";").forEach((e=>{let a=e.split("="),t=""===a[1]?null:a[1];switch(a[0]){case"badges":case"badge-info":if(t){let e={};t.split(",").forEach((l=>{let s=l.split("/");e[s[0]]=s[1]})),s[a[0]]=e}else s[a[0]]=null;break;case"emotes":if(t){let e={};t.split("/").forEach((l=>{let s=l.split(":"),a=[];s[1].split(",").forEach((e=>{let l=e.split("-");a.push({startPosition:l[0],endPosition:l[1]})})),e[s[0]]=a})),s[a[0]]=e}else s[a[0]]=null;break;case"emote-sets":let e=t.split(",");s[a[0]]=e;break;default:l.hasOwnProperty(a[0])||(s[a[0]]=t)}})),s},parseCommand=e=>{let l=null,s=e.split(" ");switch(s[0]){case"JOIN":case"PART":case"NOTICE":case"CLEARCHAT":case"HOSTTARGET":case"PRIVMSG":case"USERSTATE":case"ROOMSTATE":case"001":l={command:s[0],channel:s[1]};break;case"PING":case"GLOBALUSERSTATE":case"RECONNECT":l={command:s[0]};break;case"CAP":l={command:s[0],isCapRequestEnabled:"ACK"===s[2]};break;default:return null}return l},parseSource=e=>{if(null!=e){let l=e.split("!");return{nick:2==l.length?l[0]:null,host:2==l.length?l[1]:l[0]}}},parseParameters=(e,l)=>{let s=e.slice(1).trim(),a=s.indexOf(" ");return-1==a?l.botCommand=s.slice(0):(l.botCommand=s.slice(0,a),l.botCommandParams=s.slice(a).trim()),l}; return parseMessage(msg); }

module.exports = parseIRC;